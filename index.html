<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <title>LaraMate 　命名ジェネレータ</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>

<body class="container">

    <h1>LaraMate 命名ジェネレータ</h1>
    <p>キーワードを入力すると、モデル・テーブル・コントローラ・ビュー・DB名を自動生成し、手順に反映します。</p>
    <p>手順に沿って進めることで、ミスなくLaravelの新規プロジェクトを構築できます。</p>

    <div class="keyword-box mb-4">
        <div class="input-group">
            <span class="input-group-text">キーワード</span>
            <input type="text" id="keyword" class="form-control" placeholder="例：memberlist">

            <select id="env-select" class="form-select" style="max-width: 150px;">
                <option value="" disabled selected>開発環境</option>
                <option value="xampp">XAMPP</option>
                <option value="mamp">MAMP</option>
            </select>

            <select id="laravel-version" class="form-select" style="max-width: 120px;">
                <option value="">Laravel</option>
                <option value="10.*">10系</option>
                <option value="11.*">11系</option>
                <option value="12.*">12系</option>
            </select>

            <button class="btn btn-primary" onclick="generate()">生成</button>
        </div>
    </div>

    <div id="result-table"></div>

    <hr>

    <div id="steps" class="mt-4">

        <div class="mb-4">
            <h3>ステップ①：作業フォルダに移動</h3>
            <p>任意の作業フォルダ（例：Laravelなど）にターミナルで移動します。このフォルダ内に新しいプロジェクトが作成されます。</p>
            <div class="code-container">
                <div class="code-header">
                    💾 コード
                    <button class="copy-btn" onclick="copyCode(this)">📋 コピー</button>
                </div>
                <pre class="code-block"><code>cd Laravel</code></pre>
            </div>
        </div>

        <div class="mb-4">
            <h3>ステップ②：Laravelプロジェクト作成</h3>
            <p>Composer を使って、指定したバージョンの Laravel のひな形を新しいディレクトリにダウンロード・展開します。</p>
            <div class="code-container">
                <div class="code-header">
                    💾 コード
                    <button class="copy-btn" onclick="copyCode(this)">📋 コピー</button>
                </div>
                <pre class="code-block"><code id="project-create"></code></pre>
            </div>
        </div>

        <div class="mb-4">
            <h3>ステップ③：プロジェクトフォルダへ移動</h3>
            <p>作成された新しいプロジェクトディレクトリに移動します。以降のコマンドは全てこのディレクトリ内で実行します。</p>
            <div class="code-container">
                <div class="code-header">
                    💾 コード
                    <button class="copy-btn" onclick="copyCode(this)">📋 コピー</button>
                </div>
                <pre class="code-block"><code id="cd-project"></code></pre>
            </div>
        </div>

        <div class="mb-4">
            <h3>ステップ④：Git初期化</h3>
            <p>ローカルリポジトリ を作成し、このプロジェクトのファイルのバージョン管理を開始します。</p>
            <div class="code-container">
                <div class="code-header">
                    💾 コード
                    <button class="copy-btn" onclick="copyCode(this)">📋 コピー</button>
                </div>
                <pre class="code-block"><code>git init</code></pre>
            </div>
        </div>

        <div class="mb-4">
            <h3>ステップ⑤：.gitignore確認</h3>
            <p>Gitに含めたくないファイルやフォルダ（機密情報、自動生成物など）がリストされていることを確認します。これで DB_PASSWORD などの流出を防げます。<br>
                Laravelには最初から以下が含まれています：<br>
                ・ vendor/<br>
                ・ .env<br>
                → gitignoreで除外されているので安全。</p>
            <div class="code-container">
                <div class="code-header">
                    💾 コード
                    <button class="copy-btn" onclick="copyCode(this)">📋 コピー</button>
                </div>
                <pre class="code-block"><code></code></pre>
            </div>
        </div>

        <div class="mb-4">
            <h3>ステップ⑥：GitHubリポジトリ作成</h3>
            <p>GitHub上で、新規のリモートリポジトリを作成します。ローカルのコードをプッシュするアップロード先となります。</p>
            <div class="code-container">
                <div class="code-header">
                    💾 コード
                    <button class="copy-btn" onclick="copyCode(this)">📋 コピー</button>
                </div>
                <pre class="code-block"><code id="db-project"></code></pre>
            </div>
        </div>

        <div class="mb-4">
            <h3>ステップ⑦：GitHubとローカルを接続</h3>
            <p>ローカルリポジトリに、プッシュ先であるリモートリポジトリ（GitHub）のURLをコピーして貼り付けし、接続します。</p>
            <div class="code-container">
                <div class="code-header">
                    💾 コード
                    <button class="copy-btn" onclick="copyCode(this)">📋 コピー</button>
                </div>
                <pre class="code-block"><code id="remote-add"></code></pre>
            </div>
        </div>

        <div class="mb-4">
            <h3>ステップ⑧：最初のコミットとプッシュ</h3>
            <p>プロジェクトの全ファイルをステージングし、コミットし、GitHubへ最初のコードをアップロードします。</p>
            <div class="code-container">
                <div class="code-header">
                    💾 コード
                    <button class="copy-btn" onclick="copyCode(this)">📋 コピー</button>
                </div>
                <pre class="code-block"><code id="first-commit"></code></pre>
            </div>
        </div>

        <div class="mb-4">
            <h3>ステップ⑨：環境設定（.env）</h3>
            <p>アプリケーションがデータベースに接続するための情報（DB名、ユーザー名、パスワードなど）を設定ファイル（.env）に記述します。</p>
            <div class="code-container">
                <div class="code-header">
                    💾 コード
                    <button class="copy-btn" onclick="copyCode(this)">📋 コピー</button>
                </div>
                <pre class="code-block"><code id="env-config"></code></pre>
            </div>
        </div>

        <div class="mb-4">
            <h3>ステップ⑩：データベース作成</h3>
            <p>MySQLなどのデータベース管理ツール（phpMyAdminなど）で、ステップ⑨で指定した空のデータベースを実際に作成します。</p>
            <div class="code-container">
                <div class="code-header">
                    💾 コード
                    <button class="copy-btn" onclick="copyCode(this)">📋 コピー</button>
                </div>
                <pre class="code-block"><code id="create-db"></code></pre>
            </div>
        </div>

        <div class="mb-4">
            <h3>ステップ⑪：マイグレーション実行（標準テーブル）</h3>
            <p>Laravelに標準で用意されている users テーブル などの認証に必要なテーブルを、手順⑩で作成したデータベースに一括で作成します。</p>
            <div class="code-container">
                <div class="code-header">
                    💾 コード
                    <button class="copy-btn" onclick="copyCode(this)">📋 コピー</button>
                </div>
                <pre class="code-block"><code>php artisan migrate</code></pre>
            </div>
        </div>

        <div class="mb-4">
            <h3>ステップ⑫：マイグレーション作成</h3>
            <p>アプリで必要なカスタムテーブルの設計図（マイグレーションファイル）を生成し、カラム構造をコードで定義します。</p>
            <div class="code-container">
                <div class="code-header">
                    💾 コード
                    <button class="copy-btn" onclick="copyCode(this)">📋 コピー</button>
                </div>
                <pre class="code-block"><code id="migration"></code></pre>
            </div>
        </div>

        <div class="mb-4">
            <h3>ステップ⑬：マイグレーション実行（自作テーブル）</h3>
            <p>手順⑫で定義したテーブルの設計図を読み込み、データベースに実際のテーブルを作成します。</p>
            <div class="code-container">
                <div class="code-header">
                    💾 コード
                    <button class="copy-btn" onclick="copyCode(this)">📋 コピー</button>
                </div>
                <pre class="code-block"><code>php artisan migrate</code></pre>
            </div>
        </div>

        <div class="mb-4">
            <h3>ステップ⑭：モデル作成</h3>
            <p>データベースのテーブルとやり取りをするための モデル を作成し、データの操作ルール（$fillable など）を定義します。</p>
            <div class="code-container">
                <div class="code-header">
                    💾 コード
                    <button class="copy-btn" onclick="copyCode(this)">📋 コピー</button>
                </div>
                <pre class="code-block"><code id="model"></code></pre>
            </div>
        </div>

        <div class="mb-4">
            <h3>ステップ⑮：コントローラ作成</h3>
            <p>ユーザーからのリクエストを受け付け、処理を行い、ビューを返す役割を持つ Controller を作成します。ここでデータを取得し、ビューに渡します。</p>
            <div class="code-container">
                <div class="code-header">
                    💾 コード
                    <button class="copy-btn" onclick="copyCode(this)">📋 コピー</button>
                </div>
                <pre class="code-block"><code id="controller"></code></pre>
            </div>
        </div>

        <div class="mb-4">
            <h3>ステップ⑯：ルート設定</h3>
            <p>特定のURLへのアクセスがあったときに、どのコントローラーのどのメソッドを実行するかを定義します。</p>
            <div class="code-container">
                <div class="code-header">
                    💾 コード
                    <button class="copy-btn" onclick="copyCode(this)">📋 コピー</button>
                </div>
                <pre class="code-block"><code id="route"></code></pre>
            </div>
        </div>

        <div class="mb-4">
            <h3>ステップ⑰：ビュー呼び出し</h3>
            <p>コントローラーから渡されたデータを受け取り、HTMLとして整形して画面に表示するためのテンプレートファイル（View）を作成します。</p>
            <div class="code-container">
                <div class="code-header">
                    💾 コード
                    <button class="copy-btn" onclick="copyCode(this)">📋 コピー</button>
                </div>
                <pre class="code-block"><code id="view"></code></pre>
            </div>
        </div>

        <div class="mb-4">
            <h3>ステッ⑱：動作確認</h3>
            <p>サーバーを起動し、ブラウザで http://127.0.0.1:8000/ にアクセス。</p>
            <div class="code-container">
                <div class="code-header">
                    💾 コード
                    <button class="copy-btn" onclick="copyCode(this)">📋 コピー</button>
                </div>
                <pre class="code-block"><code>php artisan serve</code></pre>
            </div>
        </div>

        <div class="mb-4">
            <h3>ステップ⑲：GitHubに反映</h3>
            <p>GitHubへ初期設定の終わったコードをアップロードします。</p>
            <div class="code-container">
                <div class="code-header">
                    💾 コード
                    <button class="copy-btn" onclick="copyCode(this)">📋 コピー</button>
                </div>
                <pre class="code-block"><code id="last-commit"></code></pre>
            </div>
        </div>
        <h4>お疲れさまでした。</h4>
        <h4>これで、新規プロジェクト作成〜自作テーブル作成〜GitHub管理までのフローが完結です。</h4>
        <h4>ここからが本番です。頑張りましょう！</h4>
    </div>

    <script>
        // Enterキーで生成
        document.getElementById('keyword').addEventListener('keydown', function(e) {
            if (e.key === 'Enter') generate();
        });

        function generate() {
            const keyword = document.getElementById('keyword').value.trim();
            const envSelect = document.getElementById('env-select');
            const env = envSelect.value;
            const laravelVersion = document.getElementById('laravel-version').value;

            // 環境選択の初期値が選択されている場合は警告
            if (!keyword || !env) {
                alert('キーワードと開発環境を選択してください');
                return;
            }

            const Model = keyword.charAt(0).toUpperCase() + keyword.slice(1);
            const Table = keyword.toLowerCase() + 's';
            const Controller = Model + 'Controller';
            const DB = keyword.toLowerCase() + '_db';
            const Repo = keyword.toLowerCase() + '-app';

            // DBユーザー・パスワードを環境で切り替え
            let dbUser = "root";
            let dbPass = ""; // XAMPPをデフォルトに設定
            if (env === "mamp") {
                dbPass = "root";
            } else if (env === "xampp") {
                dbPass = "";
            }

            // Laravelバージョンによるコマンド切替
            let projectCommand = `composer create-project laravel/laravel ${Repo}`;
            if (laravelVersion) {
                projectCommand = `composer create-project "laravel/laravel=${laravelVersion}" ${Repo}`;
            }

            // 結果テーブル
            const tableHTML = `
            <table class="table table-bordered table-striped mt-3">
              <thead class="table-light">
                <tr><th>項目</th><th>生成結果</th></tr>
              </thead>
              <tbody>
                <tr><td>プロジェクト名</td><td>${Repo}</td></tr>
                <tr><td>GitHubリポジトリ名</td><td>${Repo}</td></tr>
                <tr><td>DB名</td><td>${DB}</td></tr>
                <tr><td>モデル名</td><td>${Model}</td></tr>
                <tr><td>テーブル名</td><td>${Table}</td></tr>
                <tr><td>コントローラ名</td><td>${Controller}</td></tr>
                <tr><td>ビュー</td><td>${Table}/index.blade.php</td></tr>
              </tbody>
            </table>`;
            document.getElementById('result-table').innerHTML = tableHTML;

            // ステップの表示
            document.getElementById('project-create').innerText = projectCommand;
            document.getElementById('cd-project').innerText = `cd ${Repo}`;
            document.getElementById('db-project').innerText = `${Repo}`;
            document.getElementById('remote-add').innerText =
                `git remote add origin https://github.com/ユーザー名/${Repo}.git`;
            document.getElementById('first-commit').innerText =
                `git add .\ngit commit -m "first commit"\ngit branch -M main\ngit push -u origin main`;
            document.getElementById('env-config').innerText =
                `DB_CONNECTION=mysql\nDB_HOST=127.0.0.1\nDB_PORT=3306\nDB_DATABASE=${DB}\nDB_USERNAME=${dbUser}\nDB_PASSWORD=${dbPass}`;
            document.getElementById('create-db').innerText =
                `CREATE DATABASE ${DB}`;
            document.getElementById('migration').innerText =
                `php artisan make:migration create_${Table}_table --create=${Table}`;
            document.getElementById('model').innerText = `php artisan make:model ${Model}`;
            document.getElementById('controller').innerText = `php artisan make:controller ${Controller}`;
            document.getElementById('route').innerText =
                `Route::get('/${Table}', [App\\Http\\Controllers\\${Controller}::class, 'index'])->name('${Table}.index');`;
            document.getElementById('view').innerText =
                `return view('${Table}/index', compact('${Table}'));`;
            document.getElementById('last-commit').innerText =
                `git add .\ngit commit -m "初期設定完了"\ngit push origin main`;

            document.getElementById('steps').style.display = "block";
        }

        function copyCode(button) {
            const code = button.closest('.code-container').querySelector('code').innerText;
            navigator.clipboard.writeText(code);
            button.innerText = '✅ コピー済み';
            setTimeout(() => button.innerText = '📋 コピー', 1500);
        }
    </script>
</body>

</html>
